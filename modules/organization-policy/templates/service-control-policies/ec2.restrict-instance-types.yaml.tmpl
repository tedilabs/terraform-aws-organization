- Effect: Deny
  Action:
  - ec2:RunInstances
  - ec2:ModifyInstanceAttribute
  Resource:
  - "*"
  Condition:
%{ if length(permittedInstanceTypes) > 0 ~}
    StringNotLike:
      "ec2:InstanceType":
%{ for instanceType in permittedInstanceTypes ~}
      - ${instanceType}
%{ endfor ~}
%{ endif ~}
%{ if length(permittedPrincipals) > 0 ~}
    ArnNotLike:
      "aws:PrincipalARN":
%{ for principal in permittedPrincipals ~}
      - ${principal}
%{ endfor ~}
%{ endif ~}

